<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema DTE - Facturaci√≥n Electr√≥nica</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.5.0/axios.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- SECCI√ìN LOGIN -->
    <div id="loginSection" class="section">
        <div class="login-container">
            <div class="login-card">
                <div class="login-left">
                    <h1>Sistema de facturaci√≥n electr√≥nica</h1>
                    <div class="company-logo">
                        Logo y nombre de la empresa
                    </div>
                </div>
                <div class="login-right">
                    <h2>Bienvenido</h2>
                    <div id="loginError" class="alert alert-error hidden"></div>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username">üë§ Usuario</label>
                            <input type="text" id="username" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label for="password">üîí Contrase√±a</label>
                            <input type="password" id="password" class="form-input" required>
                        </div>
                        <button type="submit" class="login-btn" id="loginBtn">
                            Iniciar sesi√≥n
                        </button>
                        <p class="remember-text">
                            Al usar el sistema, el usuario acepta los t√©rminos que para tal efecto ha creado.
                        </p>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- SECCI√ìN DASHBOARD -->
    <div id="dashboardSection" class="section hidden">
        <div class="dashboard">
            <div class="dashboard-header">
                <button class="menu-btn" onclick="toggleUserMenu()">‚â°</button>
                <div class="user-menu">
                    <div class="user-info" onclick="toggleUserMenu()">
                        <div class="user-avatar">üë§</div>
                        <span id="userName">Ing. Joel</span>
                    </div>
                    <div id="userDropdown" class="user-dropdown">
                        <button class="dropdown-item" onclick="editProfile()">
                            üë§ Editar informaci√≥n del emisor
                        </button>
                        <button class="dropdown-item" onclick="logout()">
                            üö™ Cerrar sesi√≥n
                        </button>
                    </div>
                </div>
            </div>

            <div class="dashboard-content">
                <div class="main-actions">
                    <button class="action-card" onclick="showSection('documentSelectionSection')">
                        <span class="action-icon">üí≥</span>
                        Facturaci√≥n
                    </button>
                    <button class="action-card" onclick="alert('Funci√≥n de clientes en desarrollo')">
                        <span class="action-icon">üë•</span>
                        Clientes
                    </button>
                    <button class="action-card" onclick="alert('Funci√≥n de inventario en desarrollo')">
                        <span class="action-icon">üìã</span>
                        Inventario
                    </button>
                </div>

                <div class="recent-section">
                    <h3>√öltimas facturas enviadas</h3>
                    <div class="recent-item">
                        <div class="recent-avatar">DG</div>
                        <div class="recent-info">
                            <div class="recent-name">David G√°lvez</div>
                            <div class="recent-type">Comprobante de cr√©dito fiscal</div>
                        </div>
                        <div class="recent-date">6/Sep/2025</div>
                    </div>
                    <div class="recent-item">
                        <div class="recent-avatar">JF</div>
                        <div class="recent-info">
                            <div class="recent-name">Joel Fuentes</div>
                            <div class="recent-type">Factura</div>
                        </div>
                        <div class="recent-date">6/Sep/2025</div>
                    </div>
                    <div class="recent-item">
                        <div class="recent-avatar">SG</div>
                        <div class="recent-info">
                            <div class="recent-name">Son Goku</div>
                            <div class="recent-type">Declaraci√≥n de renta</div>
                        </div>
                        <div class="recent-date">6/Sep/2025</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SECCI√ìN SELECCI√ìN DE DOCUMENTO -->
    <div id="documentSelectionSection" class="section hidden">
        <div class="dashboard">
            <div class="dashboard-header">
                <button class="menu-btn" onclick="toggleUserMenu()">‚â°</button>
                <div class="user-menu">
                    <div class="user-info" onclick="toggleUserMenu()">
                        <div class="user-avatar">üë§</div>
                        <span id="userName2">Ing. Joel</span>
                    </div>
                    <div id="userDropdown2" class="user-dropdown">
                        <button class="dropdown-item" onclick="editProfile()">
                            üë§ Editar informaci√≥n del emisor
                        </button>
                        <button class="dropdown-item" onclick="logout()">
                            üö™ Cerrar sesi√≥n
                        </button>
                    </div>
                </div>
            </div>

            <div class="document-selection active">
                <button class="back-btn" onclick="showSection('dashboardSection')">
                    ‚Üê Regresar al inicio
                </button>
                
                <div class="document-card">
                    <div class="document-icon">üí∞</div>
                    <h2>Seleccione el tipo de factura a realizar</h2>
                    <div class="document-types">
                        <button class="doc-type-btn" onclick="createDocument('ccf')">
                            Comprobante de cr√©dito fiscal
                        </button>
                        <button class="doc-type-btn" onclick="createDocument('factura')">
                            Factura
                        </button>
                        <button class="doc-type-btn" onclick="createDocument('declaracion')">
                            Declaraci√≥n de renta
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SECCI√ìN FORMULARIO DE DOCUMENTO -->
    <div id="documentFormSection" class="section hidden">
        <div class="dashboard">
            <div class="dashboard-header">
                <button class="menu-btn" onclick="toggleUserMenu()">‚â°</button>
                <div class="user-menu">
                    <div class="user-info" onclick="toggleUserMenu()">
                        <div class="user-avatar">üë§</div>
                        <span id="userName3">Ing. Joel</span>
                    </div>
                    <div id="userDropdown3" class="user-dropdown">
                        <button class="dropdown-item" onclick="editProfile()">
                            üë§ Editar informaci√≥n del emisor
                        </button>
                        <button class="dropdown-item" onclick="logout()">
                            üö™ Cerrar sesi√≥n
                        </button>
                    </div>
                </div>
            </div>

            <div class="document-form active">
                <button class="back-btn" onclick="showSection('documentSelectionSection')">‚Üê</button>
                
                <div class="form-header">
                    <h2 id="documentTitle">Comprobante de cr√©dito fiscal</h2>
                </div>

                <div id="documentFormAlert" class="alert alert-success hidden"></div>

                <form id="dteForm">
                    <div class="form-columns">
                        <!-- Left Column - Datos del receptor -->
                        <div class="form-section">
                            <div class="section-header">Datos del receptor</div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>NIT</label>
                                    <input type="text" name="nit" class="form-input" placeholder="0000-000000-000-0" required>
                                </div>
                                <div class="form-group">
                                    <label>NRC</label>
                                    <input type="text" name="nrc" class="form-input" placeholder="000000000000000">
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label>Nombre del cliente</label>
                                    <input type="text" name="clientName" class="form-input" placeholder="Nombre del cliente" required>
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label>Nombre comercial</label>
                                    <input type="text" name="commercialName" class="form-input" placeholder="Nombre comercial">
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label>Actividad econ√≥mica</label>
                                    <input type="text" name="economicActivity" class="form-input" placeholder="Actividad econ√≥mica">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Departamento</label>
                                    <select name="department" class="form-input" required>
                                        <option value="">Elija una opci√≥n</option>
                                        <option value="01">Ahuachap√°n</option>
                                        <option value="02">Caba√±as</option>
                                        <option value="03">Chalatenango</option>
                                        <option value="04">Cuscatl√°n</option>
                                        <option value="05">La Libertad</option>
                                        <option value="06">La Paz</option>
                                        <option value="07">La Uni√≥n</option>
                                        <option value="08">Moraz√°n</option>
                                        <option value="09">San Miguel</option>
                                        <option value="10">San Salvador</option>
                                        <option value="11">San Vicente</option>
                                        <option value="12">Santa Ana</option>
                                        <option value="13">Sonsonate</option>
                                        <option value="14">Usulut√°n</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Municipio</label>
                                    <select name="municipality" class="form-input" required>
                                        <option value="">Elija una opci√≥n</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label>Complemento de direcci√≥n</label>
                                    <input type="text" name="address" class="form-input" placeholder="Complemento de direcci√≥n">
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label>Correo electr√≥nico</label>
                                    <input type="email" name="email" class="form-input" placeholder="receptor@correo.com">
                                </div>
                            </div>

                            <div class="form-row full">
                                <div class="form-group">
                                    <label>Tel√©fono</label>
                                    <input type="tel" name="phone" class="form-input" placeholder="0000-0000">
                                </div>
                            </div>

                            <button type="button" class="login-btn" onclick="saveReceiverInfo()">
                                Guardar informaci√≥n
                            </button>
                        </div>

                        <!-- Right Column - Products and Totals -->
                        <div class="form-section">
                            <div class="section-header">Productos y Servicios</div>
                            
                            <table class="products-table">
                                <thead>
                                    <tr>
                                        <th>Cant.</th>
                                        <th>Unidad</th>
                                        <th>Producto</th>
                                        <th>Tipo de venta</th>
                                        <th>Precio</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody">
                                    <tr>
                                        <td><input type="number" name="quantity[]" value="1" min="1" step="1" onchange="calculateTotals()"></td>
                                        <td><input type="text" name="unit[]" placeholder="Unidad"></td>
                                        <td><input type="text" name="product[]" placeholder="Descripci√≥n del producto" required></td>
                                        <td>
                                            <select name="saleType[]" onchange="calculateTotals()" required>
                                                <option value="">Seleccionar</option>
                                                <option value="1">Gravado</option>
                                                <option value="2">Exento</option>
                                            </select>
                                        </td>
                                        <td><input type="number" name="price[]" step="0.01" min="0" placeholder="0.00" onchange="calculateTotals()" required></td>
                                        <td></td>
                                    </tr>
                                </tbody>
                            </table>

                            <button type="button" class="add-product-btn" onclick="addProductRow()">+</button>

                            <div style="text-align: center; color: #6b7280; margin: 20px 0;">
                                Suma total de operaciones
                            </div>

                            <div style="text-align: center; margin: 20px 0;">
                                <strong>IVA: <span id="ivaAmount">$0.00</span></strong>
                            </div>

                            <div class="totals-section">
                                <div class="total-row">
                                    <span>Subtotal:</span>
                                    <span id="subtotalAmount">$0.00</span>
                                </div>
                                <div class="total-row">
                                    <span>(-) IVA exento:</span>
                                    <span id="exemptAmount">$0.00</span>
                                </div>
                                <div class="total-row final">
                                    <span>Total a pagar:</span>
                                    <span id="totalAmount">$0.00</span>
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 30px;">
                                <label>Forma de pago</label>
                                <select name="paymentMethod" class="form-input" required>
                                    <option value="">Elija una opci√≥n</option>
                                    <option value="01">Efectivo</option>
                                    <option value="02">Cheque</option>
                                    <option value="03">Transferencia</option>
                                    <option value="04">Tarjeta de cr√©dito</option>
                                    <option value="05">Tarjeta de d√©bito</option>
                                </select>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>N¬∞ de documento del emisor</label>
                                    <input type="text" name="issuerDocNum" class="form-input" placeholder="N¬∞ de documento del emisor">
                                </div>
                                <div class="form-group">
                                    <label>Nombre del emisor</label>
                                    <input type="text" name="issuerName" class="form-input" placeholder="Nombre del emisor">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>N¬∞ de documento del receptor</label>
                                    <input type="text" name="receiverDocNum" class="form-input" placeholder="N¬∞ de documento del receptor">
                                </div>
                                <div class="form-group">
                                    <label>Nombre del receptor</label>
                                    <input type="text" name="receiverName" class="form-input" placeholder="Nombre del receptor">
                                </div>
                            </div>

                            <button type="submit" class="submit-btn" id="submitDocumentBtn">
                                Generar documento
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/products.js"></script>
    <script src="js/dte.js"></script>
    <script src="js/main.js"></script>
</body>
</html>